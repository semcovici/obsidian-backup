# Aula UNIVESP (13 e 14)

## Razões para replicação
* Confiabilidade: garante comportamento correto, apesar de erros.
	* Ex: dados corrompidos. Se corrompeu um dado, tem uma réplica
* Uma répica funcionando? O serviço continua

* Desempenho
	* É importante quando precisa ser ampliado em **quantidade** e **área geográfica**
	* Ampliação em quantidade: diversos servidores web com cache de páginas
	* ampliação geográfica: requisições são passadas para o servidor mais próximo

MAIOR PROBLEMA DA REPLICAÇÃO: CONSISTENCIA ENTRE OS DADOS DAS DIVERSAS RÉPLICAS

## Problema da consistência

* Maior dificuldade: sincronizar TODAS as réplicas
	* Precisa chegar em um acordo: quando a atualização deve ser realizada
	* Em geral, requer uma sinc global
	* A única soluçao real é relaxar as restrições de consistência
	* Haverá réplicas diferentes temporariamente 

## Modelos de consistência
Contrato de consistência entre as réplicas

### Modelos de consistencia -  Centrado em dados

Um depósito de dados - distribuidos em várias máquinas
* Cada processo que pode acessar dados do depósito tem uma cópia local (ou próxima) do depósito
* Dois tipos de operações: escrita -> altera os dados, leitura -> caso contrário
* Operações de escrita são propagadas para outras cópias
![[Pasted image 20240619224944.png]]
Note que há sempre um delay entre as atulizações, oq leva a inconsistência dependendo da definição

Modelo de consistencia
Definição: contrato entre processos e depósito de dados
*  se os processos concordarem em obedecer regras, o depósito promete funcionar de maneira correta

### Mais sobre modelos de consistencia
* Sem um relógio global - difícil definir a ordem das escritas com precisão (qual o último?)
* Modelos de consistência -> restringem efetivametne os valores que uma leitura pode retornar

Soluções eficientes:
* relaxar o conceito de consistência -> o que se pode tolerar de inconsistência depende de cada aplicação


## Consistência contínua
3 eixos independentes para definir inconsistências 
* diferentes valores numéricos entre as réplicas
* diferenças das idades entre réplicas
* diferença em relação à ordenação de operações de atualização

Referem-se à estes desvios como se formassem faixas de consistênia contínua

### Desvio numéricos
Utilizada por aplicação onde os dados têm semântica numérica:
* aplicações que dizem que duas cópias não podem desviar de 0.4 reais ou 0.05%

Desvio numérico pode expressar:
* no. de atualizações de uma réplica, mas que ainda não foram vistas pelas outras

### Desvio de Idade
Estão relacionados com a última vez que uma réplica foi atualizada

* Algumas aplicações podem tolerar que uma réplica forneça dados antigos, contanto que não sejam tão antigos
	* Previsões de tempo, em geral, permanecem semelhantes durante algum tempo.
	* Servidor principal pode receber atualiações em tempos oportunos

### Desvio em relação à ordenação de operações 

* Em algumas aplicações, a ordenação das atualizações podem ser diferentes nas réplias, dentro de um limite
* Atualizações são aplicadas a uma cópia local, à espera de um acordo global de todas as réplicas
* Algumas atualizações podem voltar atrás e serem aplicadas em uma ordem diferente
* Antes de se tornarem permanentes

### Consistência contínua - conit
conit specifica a unidade segundo a qual a consistencia deve ser medida
* registro que apresenta uma única ação
* Boletim individual de previsão de tempo
* conit - consistency Unit

![[Pasted image 20240619230600.png]]


### Consistência contínua -granuralidade
Grossa: conit com grande quantidade de dados -> réplicas entram em estado consistente mais rapido
Fina: Grande número de conits a serem gerenciados



## Consistência sequencial
![[Pasted image 20240619231725.png]]
Todos os processos veem a mesma intercação. Nesse caso, as leituras em p3 e p4 precisam ser exergados como os mesmos valores. Em A) isso acontence, em B) não

![[Pasted image 20240619232049.png]]
![[Pasted image 20240619232133.png]]
## Consistência Causal
![[Pasted image 20240619232327.png]]

![[Pasted image 20240619232452.png]]
![[Pasted image 20240619232518.png]]
## Gerenciamento de Réplicas

* Decidir onde, quando e por quem as réplicadas devem ser posicionadas
* Mecanismos para manter as réplicas consistentes

### Problema do posicionamento
Dois subproblemas:
* posicionar servidores de réplicas: achar as melhores localizações para colocar um servidor que pode hospedar um depósito de dados (encontrar o local)
* posionamento de conteúdo: achar os melhores servidores para colocar conteúdo (encontrar o servidor). 

Primeiro servidor para depois o posicionar o conteúdo

#### Posicionamento de servidor de réplicas
![[Pasted image 20240619232939.png]]
Possiveis soluções:
* distancia entre cliente e localizações
* latencia ou largura de banca entre cloente e localizações 

Outra solução:
![[Pasted image 20240619233041.png]]
![[Pasted image 20240619233111.png]]
#### Posicionamento de conteúdo
Dado o conjunto de servidores encontrado no posicionamento de servidor, onde coloco meu conteúdo?


3 tipos diferentes de réplicas organizadas logicamente
* replicas permanentes
* réplicas iniciadas por servidor 
* réplicas iniciadas por cliente
## Réplicas Permanentes
![[Pasted image 20240619233354.png]]

## Réplicas por servidor
![[Pasted image 20240619233427.png]]

### Réplicas iniciadas por servidor

![[Pasted image 20240619233538.png]]



# Aula 20

![[aula20.pdf]]
# Aula 21
![[aula21.pdf]]
# Aula 22
![[aula22.pdf]]